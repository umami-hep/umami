stages:
  - test
  - integration_test
  - image_build
  - docs_build
  - publish

variables:
  TFTAG: 2.4.0

unittest:
  stage: test
  image: python:3.7
  script:
    - pip install -r requirements.txt
    - coverage run --source=. -m  pytest ./umami/tests/ -v
    - coverage report

linter:
  stage: test
  image: python:3.7-slim
  allow_failure: true
  script:
    - pip install flake8
    - flake8 ./umami

include:
  - 'pipelines/.docker-gitlab-ci.yaml'
  - 'pipelines/.docs-gitlab-ci.yaml'
  - 'pipelines/.integration_test-gitlab-ci.yaml'